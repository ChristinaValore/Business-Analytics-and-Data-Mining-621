---
title: 'Assignment 1: Data 621'
author: "Critical Thinking Group 5 - Christina Valore, Henry Vasquez, Chunhui Zhu, Chunmei Zhu"
date: "9/16/2019"
output: html_document
---

```{r,message=F, warning=F}
library(tidyverse); library(dplyr); library(psych); library(corrplot); library (ggplot2); library(funModeling) 
```

## Money Ball

In this homework assignment, you will explore, analyze and model a data set containing approximately 2200 records. Each record represents a professional baseball team from the years 1871 to 2006 inclusive. Each record has the performance of the team for the given year, with all of the statistics adjusted to match the performance of a 162 game season.

Your objective is to build a multiple linear regression model on the training data to predict the number of wins for the team. You can only use the variables given to you (or variables that you derive from the variables provided). Below is a short description of the variables of interest in the data set:

Response variable: Target_Wins
Predictor variable(s): ?

### Data Analysis

First we import the data into a GitHub repo so files are easily accessed by the team. Then we remove any unnecessary columns such as 'index', which plays no role in our analysis. Once completed, we view the top of each dataset to ensure data was imported in the correct format.
```{r }

train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv") 

eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv") 

#remove index column
train <- select(train,-1)
eval <- select(eval,-1)

#view data for both sets, notice the index column has been removed
head (train)
head (eval)

```

### Statistics

The summary function reveals there are a considerable amount of NA's and some variables have a min of 0, which can be possible in baseball, however a variable with too many zeros will be unuseful. Additonally some variables have max values that look far off from the 3rd quartile, i.e. team_batting_3B has the 3rd q at 72, while max is 223.

```{r}
#univariate view of basic stats
summary(train)
```

### Zeros and NA values

Using the df_status function from the funModeling package, we see that the quantity of zeros (q_zeros) is quite low for all variables. This can be confirmed by percentage of zeros (p_zeros) as all fall below 1%. 

The NA values seem to be more discerning as several of the variable have high percentage NA's. Specifically the values, baserun_CS and batting_HBP which has 33.92% and 91.61% NA's respectively. 

These variables will need to be excluded from our analysis as we only want variables with less than 20% NA's. 

```{r}
#gives us information about 0's, NA's, variable type, and unique values
df_status(train)
```


```{r}
#get stats of train set
describe(train)
```

### Histograms

We can see batting_HR and pitching_HR are not normally distributed which we will need to account for whwen we build our model. Batting_H, batting_2B and batting_HBP look the most normally distributed. 

```{r}
#view graphs in 2 rows and 2 columns
par(mfrow = c(2,2))

#homerun distribution
hist(train$TEAM_BATTING_HR) 

hist(train$TEAM_PITCHING_HR) 

#hits distr.
hist(train$TEAM_BATTING_H) 

#doubles ditr.
hist(train$TEAM_BATTING_2B) 

#triples distr.
hist(train$TEAM_BATTING_3B)

#walks
hist(train$TEAM_BATTING_BB)

#batter hit by pitch
hist(train$TEAM_BATTING_HBP)

#stolen bases
hist(train$TEAM_BASERUN_SB)

#double plays
hist(train$TEAM_FIELDING_DP)

#strikeouts by pitcher
hist(train$TEAM_PITCHING_SO)

```

### Add run difference variable

Not sure how to calculate runs from the given data?
```{r}
train$RUN_DIFF = train$TEAM_BATTING_HR - train$TEAM_PITCHING_HR
```

I wanted to plot here Run diff vs Wins, however this graph looks off, there should be some runs in the positive - again I think we need an equation to calculate overal runs. 
```{r}
plot(train$RUN_DIFF, train$TARGET_WINS, xlab = "Homeruns", ylab = "Wins", title("Wins vs. homeruns"))

```


Sources: 

http://www.sthda.com/english/wiki/visualize-correlation-matrix-using-correlogram

https://kharshit.github.io/blog/2017/07/28/moneyball-how-linear-regression-changed-baseball

https://towardsdatascience.com/linear-regression-moneyball-part-1-b93b3b9f5b53

