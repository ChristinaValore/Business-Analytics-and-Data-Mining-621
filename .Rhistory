library(tidyverse); library(dplyr); library(psych); library(corrplot); library (ggplot2)
train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv")
eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv")
#view the data
head(train)
head(eval)
#remove index column
train <- select(train,-1)
eval <- select(eval,-1)
View(eval)
head (train)
head (eval)
summary(train)
sort(train$TARGET_WINS)
sort(train$TEAM_BATTING_3B)
#sort(train$TARGET_WINS)
#sort(train$TEAM_BATTING_3B)
sort(train$TEAM_BATTING_HR)
View(train)
#sort(train$TARGET_WINS)
#sort(train$TEAM_BATTING_3B)
#sort(train$TEAM_BATTING_HR)
sort(train$TEAM_BATTING_BB)
library(tidyverse); library(dplyr); library(psych); library(corrplot); library (ggplot2); library(funModeling)
df_status(train)
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
head(train )
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
View(eval)
View(train)
library(tidyverse); library(dplyr); library(psych); library(corrplot); library (ggplot2); library(funModeling)
train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv")
eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv")
#remove index column
train <- select(train,-1)
eval <- select(eval,-1)
#view data for both sets, notice the index column has been removed
head (train)
head (eval)
View(eval)
View(train)
train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv")
eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv")
train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv")
eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv")
#remove index column, which is first column in both datasets
train <- select(train,-1)
eval <- select(eval,-1)
#view data for both sets, notice the index column has been removed
head (train)
head (eval)
#univariate view of basic stats
summary(train)
#gives us information about 0's, NA's, variable type, and unique values
df_status(train)
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
head(train)
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
train <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-training-data.csv")
eval <-read.csv("https://raw.githubusercontent.com/ChristinaValore/Business-Analytics-and-Data-Mining-621/master/moneyball-evaluation-data.csv")
#remove index column, which is first column in both datasets
train <- select(train,-1)
eval <- select(eval,-1)
#view data for both sets, notice the index column has been removed
head (train)
head (eval)
train <- subset(train, select = -c(TEAM_BASERUN_CS,TEAM_BATTING_HBP))
View(train)
levels(train)
head(train)
View(eval)
m <- lm(TARGET_WINS ~ ., data=train)
cook <- cooks.distance(m)
m <- lm(TARGET_WINS ~ ., data=train)
cook <- cooks.distance(m)
plot(cook, pch="*", cex=2, main="Cooks distance: Influential Observations")  # plot Cook's distance
abline(h = 4*mean(cooksd, na.rm=T), col="red")  # add cutoff line
m <- lm(TARGET_WINS ~ ., data=train)
cook <- cooks.distance(m)
plot(cook, pch="*", cex=2, main="Cooks distance: Influential Observations")  # plot Cook's distance
abline(h = 4*mean(cook, na.rm=T), col="red")  # add cutoff line
text(x=1:length(cook)+1, y=cook, labels=ifelse(cook>4*mean(cook, na.rm=T),names(cook),""), col="red")  # add labels
influential <- as.numeric(names(cook)[(cook > 4*mean(cook, na.rm=T))])  # influential row numbers
head(train[influential, ])
car::outlierTest(m)
View(train)
View(eval)
influential <- as.numeric(names(cook)[(cook > 4*mean(cook, na.rm=T))])  # influential row numbers
train[influential, ]
library(car)
detach("package:carData", unload = TRUE)
install.packages("car")
names(cook)
influential <- as.numeric(names(cook)[(cook > 4*mean(cook, na.rm=T))]) # influential row numbers
head(train[influential, ])
View(train)
m <- lm(TARGET_WINS ~ ., data=train) # model of data with all variables considered
cook <- cooks.distance(m)
plot(cook, pch="*", cex=2, main="Cook's Distance: Influential Observations") # plot Cook's distance
abline(h = 4*mean(cook, na.rm=T), col="red") # add cutoff line = 4*mean
text(x=1:length(cook)+1, y=cook, labels=ifelse(cook>4*mean(cook, na.rm=T),names(cook),""), col="red") # add labels for points
par(mfrow = c(2,2)) #view graphs in 2x2 view
hist(train$TEAM_BATTING_HR) # homerun
hist(train$TEAM_PITCHING_HR) # homeruns allowed
hist(train$TEAM_BATTING_H) # hits
hist(train$TEAM_BATTING_2B) # doubles
hist(train$TEAM_BATTING_3B) # triples
hist(train$TEAM_BATTING_BB) # walks
hist(train$TEAM_BASERUN_SB) # stolen
hist(train$TEAM_FIELDING_DP) # double
hist(train$TEAM_PITCHING_SO) # strikeouts by pitcher
par(mfrow = c(3,3)) #view graphs in 3x3 view
hist(train$TEAM_BATTING_HR) # homerun
hist(train$TEAM_PITCHING_HR) # homeruns allowed
hist(train$TEAM_BATTING_H) # hits
hist(train$TEAM_BATTING_2B) # doubles
hist(train$TEAM_BATTING_3B) # triples
hist(train$TEAM_BATTING_BB) # walks
hist(train$TEAM_BASERUN_SB) # stolen
hist(train$TEAM_FIELDING_DP) # double
hist(train$TEAM_PITCHING_SO) # strikeouts by pitcher
